<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-gb">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>在linux下搭建PHP开发环境记实(一)</title>
	<meta name="author" content="inet" />
	<link rel="stylesheet" href="/css/screen.css" type="text/css" media="all" />
	<link rel="stylesheet" href="/css/tablet.css" type="text/css" media="screen and (min-width:651px) and (max-width: 1024px), screen and (min-device-width: 768px) and (max-device-width: 1024px)" />
	<link rel="stylesheet" href="/css/mobile.css" type="text/css" media="handheld, screen and (max-width: 650px), screen and (max-device-width: 480px)" />
     <link rel="stylesheet" href="/css/pygments.css">
</head>
<body>
	<div class="site">
		<div class="title"><a href="/">Jiangli10417<br/>Waiting for you</a></div>
		<div id="post">
	<h1>在linux下搭建PHP开发环境记实(一)</h1>
	<p class="meta">13 Oct 2012</p>
	<p>这里选用经典的组合<span style="font-family: 文泉驿等宽正黑, monospace;">apache+php+mysql</span>。</p>
<p>一、<span style="font-family: 文泉驿等宽正黑, monospace;">Apache</span>的安装与配置</p>
<p>首先安装<span style="font-family: 文泉驿等宽正黑, monospace;">Apache</span>服务器，到官网（<span style="font-family: 文泉驿等宽正黑, monospace;">httpd.apache.org)</span>下载源码包。将下载的<span style="font-family: 文泉驿等宽正黑, monospace;">httpd</span>安装包移动到<span style="font-family: 文泉驿等宽正黑, monospace;">/usr/local/work</span>目录下（如果目录不存在，可以建立该目录）。以下的操作最好是切换到管理员权限，以免出现权限不够的情况。</p>
<p>将下载的文件解压到<span style="font-family: 文泉驿等宽正黑, monospace;">work</span>目录中，进入解压后的目录。建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>，使用如下命令：</p>
<p><span style="font-family: 文泉驿等宽正黑, monospace;">./configure --prefix=/usr/local/apache -enable-module=so</span> 出现错误：</p>
<p>（<span style="font-family: 文泉驿等宽正黑, monospace;">configure: error: APR not found. Please read the documentation.)</span></p>
<p>上网查了一下这个错误提示，原因是<span style="font-family: 文泉驿等宽正黑, monospace;">apache</span>依赖<span style="font-family: 文泉驿等宽正黑, monospace;">APR</span>库。<span style="font-family: 文泉驿等宽正黑, monospace;">APR</span>的全称是<span style="font-family: 文泉驿等宽正黑, monospace;">Apache Portable Runtime</span>，其作用是 为不同的平台提供统一的接口。于是在<span style="font-family: 文泉驿等宽正黑, monospace;">apr.apache.org</span>上下载这个库。</p>
<p><!--more-->安装：<span style="font-family: 文泉驿等宽正黑, monospace;">./configure --prefix=/usr/local/apr</span>，<span style="font-family: 文泉驿等宽正黑, monospace;">make,make install</span>。</p>
<p>安装<span style="font-family: 文泉驿等宽正黑, monospace;">APR</span>成功后再重新为<span style="font-family: 文泉驿等宽正黑, monospace;">Apache</span>建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>文件：<span style="font-family: 文泉驿等宽正黑, monospace;">./configure -prefix=/usr/local/apache --with-apr=/usr/local/apr -enable-module=so</span>，又出现以下错误：</p>
<p><span style="font-family: 文泉驿等宽正黑, monospace;">(configure: error: APR-util not found. Please read the documentation.)</span></p>
<p>缺少<span style="font-family: 文泉驿等宽正黑, monospace;">APR</span>－<span style="font-family: 文泉驿等宽正黑, monospace;">util</span>库，去<span style="font-family: 文泉驿等宽正黑, monospace;">apr.apache.org</span>下载<span style="font-family: 文泉驿等宽正黑, monospace;">APR-util</span>。安装：建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>文件：<span style="font-family: 文泉驿等宽正黑, monospace;">./configure --prefix=/usr/local/apr-util -with- apr=/usr/local/apr/bin/apr-1-config</span>，<span style="font-family: 文泉驿等宽正黑, monospace;">make</span>，<span style="font-family: 文泉驿等宽正黑, monospace;">make install</span>。</p>
<p>成功安装<span style="font-family: 文泉驿等宽正黑, monospace;">APR</span>－<span style="font-family: 文泉驿等宽正黑, monospace;">util</span>后用命令：<span style="font-family: 文泉驿等宽正黑, monospace;">sudo ./configure -prefix=/usr/local/apache --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util/ -enable-module=so </span>重新为<span style="font-family: 文泉驿等宽正黑, monospace;">Aapche</span>建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>。依然出现错误：</p>
<p><span style="font-family: 文泉驿等宽正黑, monospace;">(configure: error: pcre-config for libpcre not found. PCRE is required and available from http://pcre.org/)</span></p>
<p><span style="font-family: 文泉驿等宽正黑, monospace;">google</span>问题，下载一个软件包：<span style="font-family: 文泉驿等宽正黑, monospace;"><a href="http://sourceforge.net/projects/pcre/">http://sourceforge.net/projects/pcre/</a></span>，编译之，我勒个去，这次装这么个小软件都出现问题：</p>
<p><span style="font-family: 文泉驿等宽微米黑;">ibtool: compile: unrecognized option `-DHAVE_CONFIG_H'</span></p>
<p><span style="font-family: 文泉驿等宽微米黑;">libtool: compile: Try `libtool --help' for more information.</span></p>
<p><span style="font-family: 文泉驿等宽微米黑;">make[1]: *** [pcrecpp.lo] Error 1</span></p>
<p>源码安装就这点最麻烦了，得自己解决包依赖的问题，不像用<span style="font-family: 文泉驿等宽正黑, monospace;">apt-get install</span>命令，可以自动解决这个问题，我试着用<span style="font-family: 文泉驿等宽正黑, monospace;">apt-cache search</span>搜了一下，出来了很多结果，但是不知道该装哪些，眼看源码安装都做到这份了，还是继续吧，不能半途而废呀。接着解决问题，<span style="font-family: 文泉驿等宽正黑, monospace;">google</span>一下，找出原因是没有安装<span style="font-family: 文泉驿等宽正黑, monospace;">g++</span>，装这个比较简单，直接<span style="font-family: 文泉驿等宽正黑, monospace;">apt-get install g++</span>就自动搞定了。</p>
<p>再再再次建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>文件：<span style="font-family: 文泉驿等宽正黑, monospace;">./configure -prefix=/usr/local/apache2 --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util/ --with-pcre=/usr/local/pcre/ -enable-module=so </span>，眼盯着屏幕刷刷的往下滚，唯一的愿望就是不要出现<span style="font-family: 文泉驿等宽正黑, monospace;">error</span>这个词，终于，这个愿望实现了，建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>文件成功。接下来编译：<span style="font-family: 文泉驿等宽正黑, monospace;">make</span>，很顺利没有出现什么问题，再安装：<span style="font-family: 文泉驿等宽正黑, monospace;">make install</span>，也很顺利，一气呵成，有种阳光总在风雨后的感觉啊。</p>
<p>打开浏览器输入本机回送地址，测试有没有安装成功，结果并没有出现意料中的界面。原来<span style="font-family: 文泉驿等宽正黑, monospace;">apache</span>安装好后并没有自动启动，还得手机启动她：<span style="font-family: 文泉驿等宽正黑, monospace;">/usr/local/apache/bin/apachectl start </span>，再次测试，<span style="font-family: 文泉驿等宽正黑, monospace;">OK</span>，<span style="font-family: 文泉驿等宽正黑, monospace;">it works</span>。</p>
<p>二、<span style="font-family: 文泉驿等宽正黑, monospace;">MYSQL</span>的安装与配置</p>
<p>下载的版本是<span style="font-family: 文泉驿等宽正黑, monospace;">5.0.96</span>，本来想用高版本的，可是高版本存在一个依赖其它共享库<span style="font-family: 文泉驿等宽正黑, monospace;">(libaio.so.1)</span>的问题，嫌麻烦就用老版本的吧。</p>
<p>首先建立一个<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>群组：<span style="font-family: 文泉驿等宽正黑, monospace;">groupadd mysql</span>。在<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>群组中增加一个用户<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>：<span style="font-family: 文泉驿等宽正黑, monospace;">useradd -g mysql mysql</span>。</p>
<p>把下载的文件放到<span style="font-family: 文泉驿等宽正黑, monospace;">/usr/local/work/</span>目录下，解压缩，回到<span style="font-family: 文泉驿等宽正黑, monospace;">/local</span>目录，用命令：<span style="font-family: 文泉驿等宽正黑, monospace;">ln -s work/mysql-5.0.96-linux-i686-glibc23 mysql</span>与刚才解压出来的目录建立一个符号链接目录<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>，方便以后数据库的升级。 进入<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>目录，<span style="font-family: 文泉驿等宽正黑, monospace;">chown -R mysql .</span>（注意后面有一点，表示当前目录）递归更改目录的拥有者为<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>。<span style="font-family: 文泉驿等宽正黑, monospace;">chgrp -R mysql . </span>递归更改目录的所属群组为<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>。在<span style="font-family: 文泉驿等宽正黑, monospace;">/usr/local/mysql/data</span>中建立<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>的数据库：<span style="font-family: 文泉驿等宽正黑, monospace;">scripts/mysql_install_db --user=mysql</span>。将当前目录文件的拥有才改为<span style="font-family: 文泉驿等宽正黑, monospace;">root</span>：<span style="font-family: 文泉驿等宽正黑, monospace;">chown -R root .</span>。特别的将<span style="font-family: 文泉驿等宽正黑, monospace;">data</span>目录的拥有者改为<span style="font-family: 文泉驿等宽正黑, monospace;">mysql:chown -R mysql data</span>。执行：<span style="font-family: 文泉驿等宽正黑, monospace;">cp support-files/my-medium.cnf /etc/my.cnf</span>（有什么作用没搞懂）和<span style="font-family: 文泉驿等宽正黑, monospace;">cp support-files/mysql.server /etc/init.d/mysql.server</span>（？）。</p>
<p>一切准备就绪，可以启动<span style="font-family: 文泉驿等宽正黑, monospace;">mysql</span>服务了：<span style="font-family: 文泉驿等宽正黑, monospace;">bin/mysqld_safe --user=mysql &amp;</span>。</p>
<p>启动后输入命令查看安装结果：<span style="font-family: 文泉驿等宽正黑, monospace;">bin/./mysql -uroot -p</span>，提示<span style="font-family: 文泉驿等宽正黑, monospace;">Enter password:</span>，但我不记得以前设过密码，于是输入了我系统帐户的密码，出现以下错误提示：<span style="font-family: 文泉驿等宽正黑, monospace;">ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)</span>。</p>
<p>上网查了下，才知道因为之前并没有<span style="font-family: 文泉驿等宽正黑, monospace;">root</span>用户在数据库设定密码，所以第一次登陆的时候并不需要加选项<span style="font-family: 文泉驿等宽正黑, monospace;">-p </span>。直接用： <span style="font-family: 文泉驿等宽正黑, monospace;">bin/./mysql -uroot</span>就可以进去。</p>
<p>成功进入后用：<span style="font-family: 文泉驿等宽正黑, monospace;">use mysql</span>切换用户，更改用户名为<span style="font-family: 文泉驿等宽正黑, monospace;">root</span>，主机名为<span style="font-family: 文泉驿等宽正黑, monospace;">localhost</span>的密码：<span style="font-family: 文泉驿等宽正黑, monospace;">update user set password=old_password('xxxxxxxx') where user='root' and host='localhost' ;</span>（好熟悉的语句啊，哈哈） <span style="color: #555555;"><span style="font-family: 'AR PL UMing HK';"><span style="font-family: 文泉驿等宽正黑;"><span style="font-size: small;">mysql</span></span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">更改密码后需用</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-family: 文泉驿等宽正黑;"><span style="font-size: small;">flush privileges</span></span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">刷新</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-family: 文泉驿等宽正黑;"><span style="font-size: small;">MySQL</span></span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">的系统权限相关表，否则会出现拒绝访问，还有一种方法，就是重新启动</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-family: 文泉驿等宽正黑;"><span style="font-size: small;">mysql</span></span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">服务器，来使新设置生效，这里选择前者。</span></span></span></p>
<p><span style="color: #555555;"><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">一切</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">OK</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">，退出</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">mysql</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">，重新用 </span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">bin/./mysql -uroot -p</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">，输入刚才设定的密码，显示成功进入</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">mysql</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">（当然现在再用</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">bin/./mysql -uroot</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">是进不去滴）。</span></span></span></p>
<p><span style="color: #555555;"><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">三、</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">PHP</span></span><span style="font-family: 'AR PL UMing HK';"><span style="font-size: small;">的安装与配置</span></span></span></p>
<p align="LEFT">首先查看系统中<span style="font-family: 'AR PL UMing HK', serif;">libxml2</span>的版本号，如果版本号小于<span style="font-family: 'AR PL UMing HK', serif;">2.5.10</span>，则需要安装更高版本，因为<span style="font-family: 'AR PL UMing HK', serif;">PHP5</span>必须在<span style="font-family: 'AR PL UMing HK', serif;">libxml2</span>的版本大于<span style="font-family: 'AR PL UMing HK', serif;">2.5.10</span>的前提下才能够安装。我系统上<span style="font-family: 'AR PL UMing HK', serif;">libxml2</span>的动态链接库显示是<span style="font-family: 'AR PL UMing HK', serif;">2.7.6</span>，但是一<span style="font-family: 'AR PL UMing HK', serif;">./configure</span>还是会出现这样的问题：<span style="font-family: 'AR PL UMing HK', serif;">configure: error: xml2-config not found. Please check your libxml2 installation.</span></p>
<p>很多人说去官网下一个<span style="font-family: 文泉驿等宽正黑, monospace;">libxml2</span>高版本的重新安装就行了，但觉得电脑上既然已经有<span style="font-family: 文泉驿等宽正黑, monospace;">libxml2</span>这个软件包了，可能还差一点东西，情不自禁的在终端敲入这个命令：<span style="font-family: 文泉驿等宽正黑, monospace;">sudo apt-get install libxml2-dev</span>。然后再去<span style="font-family: 文泉驿等宽正黑, monospace;">./configure</span>，居然顺利建立<span style="font-family: 文泉驿等宽正黑, monospace;">Makefile</span>文件。看来真是缺少了开发文件啊，个人很多软件都没有自动的安上这个，因为这种文件只有开发人员才用得上，一般用户安了也没用，不知道这种理解对不对呀。</p>
<p>接下来<span style="font-family: 文泉驿等宽正黑, monospace;">make,make install</span>很顺利的完成。下面就来测试一下<span style="font-family: 文泉驿等宽正黑, monospace;">PHP5</span>有没有安装成功。</p>
<p>更改<span style="font-family: 文泉驿等宽正黑, monospace;">httpd.conf</span>文件相关设置（<span style="font-family: 文泉驿等宽正黑, monospace;">/usr/local/apache2/conf</span>）。找到该文件中的如下行：</p>
<p><span style="font-family: 文泉驿等宽正黑, monospace;"> AddType application/x-gzip .gz .tgz</span></p>
<p>在该行后加如下行： <span style="font-family: 文泉驿等宽正黑, monospace;"> AddType application/x-httpd-php .php .phtml</span></p>
<p>重新启动<span style="font-family: 文泉驿等宽正黑, monospace;">Apache</span>服务器（<span style="font-family: 文泉驿等宽正黑, monospace;">sudo /usr/local/apache2/bin/./httpd -k restart),</span>并在<span style="font-family: 文泉驿等宽正黑, monospace;">apache</span>主目录中的<span style="font-family: 文泉驿等宽正黑, monospace;">htdocs</span>目录中建立文件<span style="font-family: 文泉驿等宽正黑, monospace;">test.php:</span></p>
<p><span style="font-family: 文泉驿等宽正黑, monospace;"> &lt;?php</span> <span style="font-family: 文泉驿等宽正黑, monospace;"> phpinfo();</span> <span style="font-family: 文泉驿等宽正黑, monospace;"> ?&gt;</span></p>
<p>在浏览器中输入<span style="font-family: 文泉驿等宽正黑, monospace;">127.0.0.1/test.php</span>，如果出现ｐｈｐ的配置信息则说明安装成功：</p>


</div>



<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>31 Jul 2015</span> <span class="seperator">~</span> <a href="/studying/java/2015/07/31/Gson%E7%AE%80%E8%A6%81%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0.html">Gson简要使用笔记</a></li>
    
      <li><span>20 May 2014</span> <span class="seperator">~</span> <a href="/2014/05/20/mysql%E8%AF%AD%E5%8F%A5%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8E%E4%BC%98%E5%8C%96.html">对mysql语句的性能分析与优化</a></li>
    
      <li><span>04 Apr 2014</span> <span class="seperator">~</span> <a href="/2014/04/04/linux%E4%B8%8B%E7%94%9F%E6%88%90%E7%9A%84%E6%96%87%E4%BB%B6%E8%83%BD%E8%B6%85%E8%BF%872G%E5%90%97.html">Linux下生成的文件能超过2G吗？</a></li>
    
  </ul>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'jiangli10417githubio'; // required: replace example with your forum shortname
                
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		<div class="footer" align="center">
            	<table>
                <tr>
                    <td>I'm on Github</td>
                    <td><a target="_blank" href="http://github.com/jiangli10417/">github.com/jiangli10417</a></td>
                </tr>
                <tr>
                    <td>Contact me</td>
                    <td>jiangli10417@gmail.com</td>
		 </tr>
            	</table>
        	</div>
	</div>

    <script type="text/javascript">
        var _gaq = _gaq || [];
        var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
        _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
        _gaq.push(['_setAccount', 'UA-4155555-8']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
</body>
<html>
